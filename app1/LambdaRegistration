import json, boto3, hashlib
from boto3.dynamodb.conditions import Key, Attr

def lambda_handler(event, context):
    accessKey =  ""
    secretKey = ""
    sessToken = ""

    
    email = event["Email"]
    password = event["Password"]
    name = event["Name"]
    
    
    dynamodb = boto3.resource('dynamodb', aws_access_key_id= accessKey, aws_secret_access_key= secretKey, aws_session_token = sessToken)
    if len(name) == 0 or len(password) == 0:
        return "FAILURE" 
    else:  
            
        # Add Verify if an account with a similar username already exists, if not create account, redirect to login   
        table = dynamodb.Table('users')
        response = table.query(KeyConditionExpression=Key('email').eq(email))
        try:
            if(response['Count'] > 0):
               return "FAILURE"
            else:   
                table.put_item(
                    Item={
                        'email': email,
                        'name' : name,
                        'password': password,
                    }
                )  
                return "SUCCESS"
        except:
            return "FAILURE"  
    return "FAILURE"         